(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[472],{87588:function(P,Z,a){"use strict";var c=a(22122),d=a(67294),y=a(61144),l=a(65734),t=function(p,m){return d.createElement(l.Z,(0,c.Z)({},p,{ref:m,icon:y.Z}))};Z.Z=d.forwardRef(t)},63549:function(P){P.exports={"table-wrapper":"table-wrapper___24Zk1",actions:"actions___79eP3"}},91180:function(P,Z,a){"use strict";a.r(Z),a.d(Z,{default:function(){return F}});var c=a(8963),d=a(38291),y=a(34792),l=a(48086),t=a(90636),v=a(11849),p=a(3182),m=a(2824),x=a(49111),I=a(19650),de=a(57663),O=a(71577),pe=a(71194),D=a(50146),T=a(67294),U=a(96486),V=a(36773),$=a(87588),K=a(81910),M=a(29811),Y=a(43358),b=a(34041),fe=a(47673),C=a(77808),he=a(9715),R=a(71481),q=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,i=a(85893),ee={labelCol:{span:6},wrapperCol:{span:16}},k=function(s){var A=(0,K.tT)("@@initialState"),w=A.initialState,L=[{label:"\u7BA1\u7406\u5458",value:4}];w&&w.user&&w.user.userRole===5&&L.push({label:"\u8D85\u7EA7\u7BA1\u7406\u5458",value:5});var _=R.Z.useForm(),W=(0,m.Z)(_,1),h=W[0],r=function(){var n=(0,p.Z)((0,t.Z)().mark(function e(){var S,z;return(0,t.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,h.validateFields();case 2:return S=g.sent,z={phone:S.phone,username:S.username,role:S.role},s.type==="edit"&&Object.assign(z,{userID:s.managerData.userID}),g.prev=5,g.next=8,M.uO(z);case 8:l.ZP.success("\u64CD\u4F5C\u6210\u529F"),s.onOk(),g.next=14;break;case 12:g.prev=12,g.t0=g.catch(5);case 14:case"end":return g.stop()}},e,null,[[5,12]])}));return function(){return n.apply(this,arguments)}}(),u=function(){h.resetFields(),s.onCancel()};return s.type==="edit"&&s.managerData&&h.setFieldsValue({username:s.managerData.username,phone:s.managerData.phone,role:s.managerData.role}),(0,T.useEffect)(function(){h.setFieldsValue({username:s.managerData.username,phone:s.managerData.phone,role:s.managerData.role})},[s.managerData]),(0,i.jsx)(D.Z,{bodyStyle:{padding:"24px"},centered:!0,onCancel:u,onOk:r,open:s.visible,title:s.type==="add"?"\u65B0\u589E\u7BA1\u7406\u5458":"\u7F16\u8F91\u7BA1\u7406\u5458",children:(0,i.jsxs)(R.Z,(0,v.Z)((0,v.Z)({form:h},ee),{},{children:[(0,i.jsx)(R.Z.Item,{name:"username",label:"\u59D3\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165"}],children:(0,i.jsx)(C.Z,{disabled:s.type==="edit"})}),(0,i.jsx)(R.Z.Item,{name:"phone",label:"\u624B\u673A\u53F7",rules:[{required:!0},function(){return{validator:function(e,S){return q.test(S)?Promise.resolve():Promise.reject("\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E")}}}],children:(0,i.jsx)(C.Z,{disabled:s.type==="edit"})}),(0,i.jsx)(R.Z.Item,{name:"role",label:"\u89D2\u8272",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],children:(0,i.jsx)(b.Z,{options:L})})]}))})},re=k,G=a(63549),J=a.n(G),B=D.Z.confirm,ne=function(){var s=(0,K.tT)("@@initialState"),A=s.initialState,w=[{title:"\u59D3\u540D",dataIndex:"username",key:"username"},{title:"\u624B\u673A\u53F7\u7801",dataIndex:"phone",key:"phone"},{title:"\u6743\u9650\u7B49\u7EA7",dataIndex:"roleName",key:"roleName"},{title:"\u6743\u9650\u8BF4\u660E",dataIndex:"comment",key:"comment"},{title:"\u64CD\u4F5C",dataIndex:"action",key:"action",render:function(o,j){return ye===1&&j.role===5?"-":(0,i.jsxs)(I.Z,{children:[(0,i.jsx)(O.Z,{type:"link",onClick:function(){return Oe(j)},children:"\u4FEE\u6539"}),(0,i.jsx)(O.Z,{type:"link",onClick:function(){return Me(j)},children:"\u5220\u9664"})]})}}],L=(0,T.useState)(!1),_=(0,m.Z)(L,2),W=_[0],h=_[1],r=(0,T.useState)({current:1,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(o){return"\u603B\u5171 ".concat(o," \u6761")}}),u=(0,m.Z)(r,2),n=u[0],e=u[1],S=function(o){e({current:o.current||1,pageSize:o.pageSize||10})},z=(0,T.useState)([]),Q=(0,m.Z)(z,2),g=Q[0],ge=Q[1],ve=(0,T.useState)(0),te=(0,m.Z)(ve,2),ye=te[0],Ze=te[1],H=(0,U.debounce)((0,p.Z)((0,t.Z)().mark(function E(){var o;return(0,t.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,h(!0),f.next=4,M.v5({pageNum:n.current,pageSize:n.pageSize});case 4:o=f.sent,o&&(ge(o.list),e((0,v.Z)((0,v.Z)({},n),{},{total:o.totalNum})),Ze(o.rootNum)),h(!1),f.next=12;break;case 9:f.prev=9,f.t0=f.catch(0),h(!1);case 12:case"end":return f.stop()}},E,null,[[0,9]])})));(0,T.useEffect)(function(){H()},[n.current,n.pageSize]);var Te=(0,T.useState)(!1),ue=(0,m.Z)(Te,2),se=ue[0],X=ue[1],Re=(0,T.useState)("add"),ie=(0,m.Z)(Re,2),we=ie[0],le=ie[1],Ee=(0,T.useState)({}),oe=(0,m.Z)(Ee,2),_e=oe[0],ce=oe[1],Se=function(){X(!0),le("add")},me=function(){X(!1),ce({})},Oe=function(o){X(!0),le("edit"),ce({username:o.username,phone:o.phone,role:o.role})},Me=function(o){B({title:"\u5220\u9664\u786E\u8BA4",icon:(0,i.jsx)($.Z,{}),content:"\u786E\u5B9A\u5220\u9664\u8BE5\u8D26\u53F7\u5417\uFF1F\u8BF7\u8C28\u614E\u64CD\u4F5C",onOk:function(){return(0,p.Z)((0,t.Z)().mark(function f(){return(0,t.Z)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,M.h8({userID:o.userID});case 2:l.ZP.success("\u64CD\u4F5C\u6210\u529F"),H();case 4:case"end":return N.stop()}},f)}))()},onCancel:function(){}})},Pe=function(){H(),me()};return(0,i.jsx)(V.ZP,{children:(0,i.jsxs)("div",{className:J()["table-wrapper"],children:[(0,i.jsx)("div",{className:J().actions,children:A&&A.user&&A.user.userRole===5&&(0,i.jsx)(O.Z,{type:"primary",onClick:Se,children:"\u65B0\u589E\u7BA1\u7406\u5458"})}),(0,i.jsx)(d.Z,{rowKey:"userID",columns:w,dataSource:g,loading:W,onChange:S,pagination:n,scroll:{x:"max-content"}}),se&&(0,i.jsx)(re,{managerData:_e,onCancel:me,onOk:Pe,type:we,visible:se})]})})},F=ne},29811:function(P,Z,a){"use strict";a.d(Z,{x4:function(){return t},Z3:function(){return p},uO:function(){return V},v5:function(){return K},h8:function(){return Y}});var c=a(90636),d=a(3182),y=a(99871),l=a(636);function t(r){return v.apply(this,arguments)}function v(){return v=(0,d.Z)((0,c.Z)().mark(function r(u){return(0,c.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.Z)("/api/v1/user/login",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),v.apply(this,arguments)}function p(r){return m.apply(this,arguments)}function m(){return m=(0,d.Z)((0,c.Z)().mark(function r(u){return(0,c.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.Z)("/api/v1/user/sendCode",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),m.apply(this,arguments)}function x(r){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("api/v1/user/submitRole",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),I.apply(this,arguments)}function de(){return O.apply(this,arguments)}function O(){return O=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("api/v1/user/verifyInfo",{method:"POST"}));case 1:case"end":return n.stop()}},r)})),O.apply(this,arguments)}function pe(){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("api/v1/user/info",{method:"GET"}));case 1:case"end":return n.stop()}},r)})),D.apply(this,arguments)}function T(r){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("api/v1/user/modifyInfo",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),U.apply(this,arguments)}function V(r){return $.apply(this,arguments)}function $(){return $=(0,d.Z)((0,c.Z)().mark(function r(u){return(0,c.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.Z)("/api/v1/user/assignAdmin",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),$.apply(this,arguments)}function K(r){return M.apply(this,arguments)}function M(){return M=(0,d.Z)((0,c.Z)().mark(function r(u){return(0,c.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.Z)("/api/v1/user/getAdmins?".concat((0,y.R)(u))));case 1:case"end":return e.stop()}},r)})),M.apply(this,arguments)}function Y(r){return b.apply(this,arguments)}function b(){return b=(0,d.Z)((0,c.Z)().mark(function r(u){return(0,c.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,l.Z)("/api/v1/user/deleteUser",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),b.apply(this,arguments)}function fe(r){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/v1/common/area?".concat(objectToUrlParams(u)),{method:"GET"}));case 1:case"end":return e.stop()}},r)})),C.apply(this,arguments)}function he(r){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/v1/common/uploadFile",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),R.apply(this,arguments)}function q(r){return i.apply(this,arguments)}function i(){return i=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/v1/common/uploadFile",{method:"DELETE",data:u}));case 1:case"end":return e.stop()}},r)})),i.apply(this,arguments)}function ee(){return k.apply(this,arguments)}function k(){return k=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/user/getAddressList",{method:"GET"}));case 1:case"end":return n.stop()}},r)})),k.apply(this,arguments)}function re(r){return G.apply(this,arguments)}function G(){return G=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/v1/user/addAddress",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),G.apply(this,arguments)}function J(r){return B.apply(this,arguments)}function B(){return B=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/v1/user/modifyAddress",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),B.apply(this,arguments)}function ne(r){return F.apply(this,arguments)}function F(){return F=_asyncToGenerator(_regeneratorRuntime().mark(function r(u){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/v1/user/deleteAddress",{method:"POST",data:u}));case 1:case"end":return e.stop()}},r)})),F.apply(this,arguments)}function ae(){return s.apply(this,arguments)}function s(){return s=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}},r)})),s.apply(this,arguments)}function A(){return w.apply(this,arguments)}function w(){return w=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}},r)})),w.apply(this,arguments)}function L(){return _.apply(this,arguments)}function _(){return _=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}},r)})),_.apply(this,arguments)}function W(){return h.apply(this,arguments)}function h(){return h=_asyncToGenerator(_regeneratorRuntime().mark(function r(){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}},r)})),h.apply(this,arguments)}},99871:function(P,Z,a){"use strict";a.d(Z,{R:function(){return c},D:function(){return d}});function c(y){var l=Object.keys(y).map(function(t){return"".concat(t,"=").concat(y[t])});return l.join("&")}function d(y){var l=new RegExp("(^|&)"+y+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(l);return t!=null?decodeURIComponent(t[2]):null}},636:function(P,Z,a){"use strict";var c=a(34792),d=a(48086),y=a(12666),l=y.Z.create({baseURL:"/",timeout:3e4,withCredentials:!1});l.interceptors.request.use(function(t){t&&t.headers&&(t.headers["Content-Type"]||(t.headers["Content-Type"]="application/json"));var v=localStorage.getItem("token");return(t==null?void 0:t.url)!=="/api/v1/user/login"&&(t.headers.Authorization="".concat(v)),t},function(t){return Promise.reject(t)}),l.interceptors.response.use(function(t){var v=t.data,p=t.data,m=t.status,x=t.statusText;if(m!==200)return d.ZP.error(x),p;if(p.status===10010)return p;if(p.status!==200)throw d.ZP.error(p.data||t.msg),new Error(t.msg);return p.data},function(t){return console.log("err"+t),Promise.reject(t)}),Z.Z=l}}]);
